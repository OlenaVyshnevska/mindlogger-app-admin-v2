webpackJsonp([1],{"1/oy":function(t,e){},"45c4":function(t,e,a){t.exports=a.p+"static/img/undraw_experts3_3njd.8f05786.svg"},"4QcR":function(t,e){},"4r4C":function(t,e,a){t.exports=a.p+"static/img/undraw_data_trends_b0wg.57a833b.svg"},"9M+g":function(t,e){},GfHa:function(t,e){},H3kZ:function(t,e){},Hp3F:function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},KXEG:function(t,e){},Ml02:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),r=a("mvHQ"),i=a.n(r),n=a("e6fC"),o=a("M4fF"),l=a.n(o),c=(a("Jmt5"),a("9M+g"),a("jKqc"),a("UKw4"));s.a.use(n.a);var u={name:"App",data:function(){return{user:{},authToken:{}}},computed:{isLoggedIn:function(){return!l.a.isEmpty(this.user)}},mounted:function(){this.user=JSON.parse(c.getItem("user"))||{},this.authToken=JSON.parse(c.getItem("authToken"))||{}},methods:{saveToken:function(t){console.log(t),this.user=t.user,this.authToken=t.authToken,c.setItem("user",i()(t.user)),c.setItem("authToken",i()(t.authToken))},logout:function(){this.user={},this.authToken={},c.setItem("user",{}),c.setItem("authToken",{})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("b-navbar",{attrs:{toggleable:"md",type:"light",variant:"light"}},[a("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),a("b-navbar-brand",{attrs:{to:"/"}},[t._v("Mindlogger")]),t._v(" "),a("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[a("b-navbar-nav",[t.isLoggedIn?a("b-nav-item",{attrs:{to:"/activitySets",exact:""}},[t._v("Your Activity Sets")]):t._e()],1),t._v(" "),a("b-navbar-nav",{staticClass:"ml-auto"},[t.isLoggedIn?a("b-nav-item-dropdown",{attrs:{right:""}},[a("template",{slot:"button-content"},[a("em",[t._v(t._s(t.user.login))])]),t._v(" "),a("b-dropdown-item",{attrs:{href:"#"}},[t._v("Profile")]),t._v(" "),a("b-dropdown-item",{on:{click:t.logout}},[t._v("Signout")])],2):a("b-nav-item",{attrs:{to:"/login"}},[t._v("Login")])],1)],1)],1),t._v(" "),a("div",{},[a("router-view",{attrs:{isLoggedIn:t.isLoggedIn,user:t.user,authToken:t.authToken},on:{login:t.saveToken}})],1)],1)},staticRenderFns:[]};var h=a("VU/8")(u,d,!1,function(t){a("Ml02")},null,null).exports,m=a("/ocq"),v={name:"HelloWorld",props:{isLoggedIn:{type:Boolean},user:{type:Object}},data:function(){return{msg:"Welcome to Your Vue.js App"}},mounted:function(){}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home mt-3"},[s("b-container",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 text-center"},[s("h1",[t._v("Mindlogger Admin Dashboard v2")]),t._v(" "),s("p",{staticClass:"lead"},[t._v("A dashboard to build mindlogger applications and visualize data")])])]),t._v(" "),s("b-row",{staticClass:"mt-3 pt-3"},[s("b-col",{staticClass:"text-center"},[s("img",{staticClass:"mx-auto w-100",attrs:{src:a("f47A")}})]),t._v(" "),s("b-col",{staticClass:"text-center"},[s("img",{staticClass:"mx-auto w-100",attrs:{src:a("4r4C")}})]),t._v(" "),s("b-col",{staticClass:"text-center"},[s("img",{staticClass:"mx-auto w-100",attrs:{src:a("45c4")}})])],1),t._v(" "),s("b-row",{staticClass:"mt-2 mb-3 pb-3"},[s("b-col",{staticClass:"text-center"},[s("p",[t._v("\n          Build Mindlogger EMAs\n        ")])]),t._v(" "),s("b-col",{staticClass:"text-center"},[s("p",[t._v("\n          Visualize, interact with, and download data\n        ")])]),t._v(" "),s("b-col",{staticClass:"text-center"},[s("p",[t._v("\n          Manage study roles\n        ")])])],1),t._v(" "),s("div",{staticClass:"row mt-3"},[t.isLoggedIn?s("div",{staticClass:"col-12 text-center"},[s("h3",[t._v("Welcome, "+t._s(t.user.firstName)+" !")]),t._v(" "),s("b-button",{attrs:{variant:"primary",to:"/activitySets"}},[t._v("Manage Activity Sets")])],1):s("div",{staticClass:"col-12 text-center"},[s("b-button",{attrs:{variant:"primary",to:"/login"}},[t._v("Log In")]),t._v(" "),s("b-button",{attrs:{variant:"success",to:"/signup"}},[t._v("Sign Up")])],1)])],1)],1)},staticRenderFns:[]};var p=a("VU/8")(v,f,!1,function(t){a("Vdvp")},"data-v-6e3aeddb",null).exports,g=(a("+6Bu"),a("Dd8w")),b=a.n(g),_=a("fZjL"),y=a.n(_),w=a("mtWM"),j=a.n(w),x="https://api.mindlogger.info/api/v1";var D=function(t){var e=t.user,a=t.password;return j()({method:"get",url:x+"/user/authentication",headers:{"Girder-Authorization":"Basic "+btoa(e+":"+a)}})},k=function(t){return j()({method:"GET",url:x+"/folder?parentId="+t+"&parentType=collection"})},C=function(t){return x+"/"+t+"/download?contentDisposition=inline"},I=function(t){return j()({method:"GET",url:x+"/user/"+t})};console.log(D);var M={name:"login",data:function(){return{form:{username:null,password:null},errors:{message:null,show:!1,code:null}}},methods:{onSubmit:function(t){var e=this;t.preventDefault(),D({user:this.form.username,password:this.form.password}).then(function(t){e.$emit("login",t.data),e.$router.push("/activitySets")}).catch(function(t){e.errors.code=t.response,401===e.errors.code.status?e.errors.message="We have no record of your username. Please create a new account!":e.errors.message=t.message,e.errors.show=!0})}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-center",attrs:{id:"login"}},[a("h1",[t._v(" Log In ")]),t._v(" "),a("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[a("b-alert",{attrs:{show:t.errors.show,variant:"danger"}},[t._v(t._s(t.errors.message))]),t._v(" "),a("b-form",{on:{submit:t.onSubmit}},[a("b-form-group",{attrs:{id:"usernameInputGroup",label:"Username:","label-for":"username"}},[a("b-form-input",{attrs:{id:"username",required:"",placeholder:"Enter email"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t._v(" "),a("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[a("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Submit")])],1),t._v(" "),a("p",{staticClass:"mt-3"},[t._v("\n      Don't have an account? "),a("router-link",{attrs:{to:"/signup"}},[t._v("Create one")])],1),t._v(" "),a("p",{staticClass:"mt-3"},[t._v("\n      Forgot your password? "),a("router-link",{attrs:{to:"/login"}},[t._v("Reset it")])],1)],1)])},staticRenderFns:[]};var R=a("VU/8")(M,S,!1,function(t){a("aecc")},null,null).exports,A={name:"signup",data:function(){return{form:{email:"",password:"",password2:"",login:"",firstName:"",lastName:""},show:!0,errors:{show:!1,message:null,code:null}}},computed:{validated:function(){return this.form.password===this.form.password2}},methods:{onSubmit:function(t){var e,a=this;t.preventDefault(),(e={email:this.form.email,password:this.form.password,login:this.form.login,firstName:this.form.firstName,lastName:this.form.lastName},j()({method:"post",url:x+"/user",params:b()({},e,{admin:!0})})).then(function(t){var e=l.a.filter(y()(t.data),function(t){return"authToken"!==t}),s={};l.a.map(e,function(e){s[e]=t.data[e]}),a.$emit("login",{authToken:t.data.authToken,user:s}),a.$router.push("/activitySets")}).catch(function(t){a.errors.show=!0,a.errors.code=t.response,a.errors.message=t.response.data.message})}}},U={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pt-3",attrs:{id:"signup"}},[a("h1",{staticClass:"text-center"},[t._v(" Sign Up ")]),t._v(" "),a("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[a("b-form",{attrs:{validated:""},on:{submit:t.onSubmit}},[a("b-alert",{attrs:{show:t.errors.show,variant:"danger"}},[t._v(t._s(t.errors.message))]),t._v(" "),a("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress",description:"We'll never share your email with anyone else."}},[a("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),a("b-form-group",{attrs:{id:"usernameInputGroup",label:"Username:","label-for":"usernameInput",description:""}},[a("b-form-input",{attrs:{id:"usernameInput",type:"text",required:"",placeholder:"Choose a username"},model:{value:t.form.login,callback:function(e){t.$set(t.form,"login",e)},expression:"form.login"}})],1),t._v(" "),a("b-form-group",{attrs:{id:"firstNameInputGroup",label:"First Name:","label-for":"firstNameInput",description:""}},[a("b-form-input",{attrs:{id:"firstNameInput",type:"text",required:"",placeholder:"First Name"},model:{value:t.form.firstName,callback:function(e){t.$set(t.form,"firstName",e)},expression:"form.firstName"}})],1),t._v(" "),a("b-form-group",{attrs:{id:"lastNameInputGroup",label:"Last Name:","label-for":"lastNameInput",description:""}},[a("b-form-input",{attrs:{id:"lastNameInput",type:"text",required:"",placeholder:"Last Name"},model:{value:t.form.lastName,callback:function(e){t.$set(t.form,"lastName",e)},expression:"form.lastName"}})],1),t._v(" "),a("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[a("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("b-form-group",{attrs:{id:"password2InputGroup",label:"Confirm Password:","label-for":"password2Input"}},[a("b-alert",{attrs:{show:!t.validated,variant:"danger"}},[t._v("\n          Make sure your passwords match!\n        ")]),t._v(" "),a("b-form-input",{attrs:{id:"password2Input",type:"password",required:"",placeholder:"Confirm password"},model:{value:t.form.password2,callback:function(e){t.$set(t.form,"password2",e)},expression:"form.password2"}})],1),t._v(" "),a("b-button",{attrs:{type:"submit",variant:"primary",disabled:!t.validated}},[t._v("Submit")]),t._v(" "),a("p",{staticClass:"mt-3"},[t._v("\n        Already have an account? "),a("router-link",{attrs:{to:"/login"}},[t._v("Log In")])],1)],1)],1)])},staticRenderFns:[]};var T=a("VU/8")(A,U,!1,function(t){a("VlMO")},null,null).exports,N={name:"ActivitySets",props:{isLoggedIn:{type:Boolean},user:{type:Object}},data:function(){return{allActivitySets:[],userTableFields:["logo","shortName","role","actions"],remainingTableFields:["logo","shortName","description"]}},computed:{userActivitySets:function(){var t=this;return this.isLoggedIn?l.a.filter(this.allActivitySets,function(e){return t.isEditor(e)||t.isManager(e)||t.isViewer(e)}):[]},remainingActivitySets:function(){var t=this;return this.isLoggedIn?l.a.filter(this.allActivitySets,function(e){return!t.isEditor(e)&&!t.isManager(e)&&!t.isViewer(e)}):this.allActivitySets},userActivityMeta:function(){return l.a.map(this.userActivitySets,function(t){return t.meta})},userActivityTable:function(){var t=this;return l.a.map(this.userActivityMeta,function(e,a){return{logoImage:e.logoImage,shortName:e.shortName,description:e.description,role:t.getRole(t.userActivitySets[a]).join([", "]),activityId:t.userActivitySets[a]._id}})},remainingActivityMeta:function(){return l.a.map(this.remainingActivitySets,function(t){return t.meta})},remainingActivityTable:function(){return l.a.map(this.remainingActivityMeta,function(t){return{logoImage:t.logoImage,shortName:t.shortName,description:t.description}})}},mounted:function(){var t=this;j()({method:"GET",url:x+"/collection/?text=Volumes"}).then(function(t){return t.data[0]._id}).then(k).then(function(e){t.allActivitySets=e.data})},methods:{isEditor:function(t){var e=this.user._id;return t.meta.members.editors.indexOf(e)>-1},isManager:function(t){var e=this.user._id;return t.meta.members.managers.indexOf(e)>-1},isViewer:function(t){var e=this.user._id;return y()(t.meta.members.viewers).indexOf(e)>-1},getRole:function(t){this.user._id;var e=[this.isEditor(t),this.isManager(t),this.isViewer(t)];return l.a.filter(["Editor","Manager","Viewer"],function(t,a){return e[a]})},getImageURL:function(t){return C(t)}}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-container",{staticClass:"p-3"},[a("b-row",[a("b-col",{staticClass:"text-center"},[a("h1",[t._v("Activity Sets")]),t._v(" "),a("p",{staticClass:"lead"},[t._v("A collection of activities.")])])],1),t._v(" "),t.isLoggedIn?a("b-row",[a("b-col",[a("h2",[t._v("Your Activity Sets")]),t._v(" "),a("p",{staticClass:"lead"},[t._v("\n        Here are the activies you own, manage, or can view.\n      ")]),t._v(" "),a("b-table",{attrs:{striped:"",hover:"",items:t.userActivityTable,fields:t.userTableFields},scopedSlots:t._u([{key:"logo",fn:function(e){return[e.item.logoImage?a("span",[a("img",{staticClass:"tableLogo",attrs:{src:t.getImageURL(e.item.logoImage["@id"])}})]):t._e()]}},{key:"actions",fn:function(e){return[e.item.role.indexOf("Editor")>-1?a("span",[a("b-button",{attrs:{size:"sm",variant:"secondary",to:"/edit_activity/"+e.item.activityId}},[t._v("\n               Edit\n             ")])],1):t._e(),t._v(" "),e.item.role.indexOf("Viewer")>-1?a("span",[a("b-button",{attrs:{size:"sm",variant:"info",to:"/view_activity/"+e.item.activityId}},[t._v("\n               View\n             ")])],1):t._e()]}}])})],1)],1):t._e(),t._v(" "),a("b-row",{staticClass:"mt-3"},[a("b-col",[a("h2",[t._v("Public Activity Sets")]),t._v(" "),a("p",{staticClass:"lead"},[t._v("\n        Here are all the other activity sets. You don't have permission to see them, though.\n      ")]),t._v(" "),a("b-table",{attrs:{striped:"",hover:"",items:t.remainingActivityTable,fields:t.remainingTableFields},scopedSlots:t._u([{key:"logo",fn:function(e){return[e.item.logoImage?a("span",[a("img",{staticClass:"tableLogo",attrs:{src:t.getImageURL(e.item.logoImage["@id"])}})]):t._e()]}}])})],1)],1)],1)},staticRenderFns:[]};var E=a("VU/8")(N,F,!1,function(t){a("H3kZ")},"data-v-9ffb16c2",null).exports,z={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"layer-preloader"},[e("div",{staticClass:"loading"},[e("div",{staticClass:"loader firstColor"},[e("div",{staticClass:"loader secondColor"},[e("div",{staticClass:"loader thirdColor"})])])])])}]};var L=a("VU/8")({},z,!1,function(t){a("KXEG")},null,null).exports,V={render:function(){var t=this.$createElement;return(this._self._c||t)("h1",[this._v(" Unauthorized ")])},staticRenderFns:[]},$=a("VU/8")(null,V,!1,null,null,null).exports,O={name:"viewActivity",props:{user:{type:Object},isLoggedIn:{type:Boolean},authToken:{type:Object}},components:{Loading:L,Unauthorized:$},data:function(){return{activityData:{},status:"loading",userData:{},userSearch:""}},computed:{activityId:function(){return this.$route.params.activityId},viewableUsers:function(){return this.activityData.meta.members.viewers[this.user._id]},currentRoute:function(){return this.$router.currentRoute.name},searchUsers:function(){var t=this;return this.userSearch?l.a.filter(this.viewableUsers,function(e){return(t.userData[e].firstName.toLowerCase()+t.userData[e].lastName.toLowerCase()).indexOf(t.userSearch.toLowerCase())>-1}):this.viewableUsers}},methods:{getActivitySet:function(){var t,e=this;return(t=this.activityId,j()({method:"GET",url:x+"/folder/"+t})).then(function(t){e.activityData=t.data})},isViewer:function(t){var e=this.user._id;return y()(t.meta.members.viewers).indexOf(e)>-1},getUserMetadata:function(t){var e=this;console.log("getting usermetedata",t),I(t).then(function(a){e.userData[t]=a.data,e.$forceUpdate()})}},mounted:function(){var t=this;this.status="loading",this.getActivitySet().then(function(){t.status="complete",l.a.map(t.viewableUsers,t.getUserMetadata),t.isViewer(t.activityData)&&t.isLoggedIn||(t.status="unauthorized")})}},q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["loading"===t.status?a("Loading"):"unauthorized"===t.status?a("Unauthorized"):t.isLoggedIn?a("div",{staticClass:"activitySetOverview"},[a("b-row",[a("b-col",{staticClass:"pt-3 bg-light col-md-3 col-sm-12 col-xs-12"},[a("b-nav",{staticClass:"w-100",attrs:{vertical:"",pills:""}},[t.isLoggedIn?a("b-nav-item",{attrs:{to:"/activitySets",exact:""}},[a("i",{staticClass:"fas fa-long-arrow-alt-left"}),t._v("\n          Your Activity Sets\n          ")]):t._e(),t._v(" "),a("b-nav-item",{attrs:{to:"/view_activity/"+t.activityId+"/overview"}},[t._v("\n            Overview\n          ")]),t._v(" "),a("b-nav-text",{staticClass:"text-center"},[t._v("Users")]),t._v(" "),a("b-nav-form",{staticClass:"ml-3"},[a("b-form-input",{staticClass:"mx-auto w-100",attrs:{type:"text",placeholder:"Search"},model:{value:t.userSearch,callback:function(e){t.userSearch=e},expression:"userSearch"}})],1),t._v(" "),a("div",{staticClass:"mt-3"},t._l(t.searchUsers,function(e){return a("b-nav-item",{key:e,staticClass:"w-100",attrs:{to:"/view_activity/"+t.activityId+"/view_user/"+e}},[t.userData[e]?a("span",[t._v("\n                "+t._s(t.userData[e].lastName)+", "+t._s(t.userData[e].firstName)+"\n               ")]):t._e()])}),1)],1)],1),t._v(" "),a("b-col",{staticClass:"p-3 col-md-9 col-sm-12 col-xs-12"},[a("router-view",{attrs:{activityData:t.activityData,authToken:t.authToken}})],1)],1)],1):a("Unauthorized")],1)},staticRenderFns:[]};var G=a("VU/8")(O,q,!1,function(t){a("SBQD")},"data-v-13738668",null).exports,H={name:"ActivitySetOverview",props:{activityData:{type:Object}},methods:{getImageURL:function(t){return C(t)}}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-container",{staticClass:"minW"},[a("b-row",[a("b-col",[a("h1",{staticClass:"text-center"},[t.activityData.meta.logoImage?a("b-img",{attrs:{thumbnail:"",rounded:"",width:"75",height:"75","blank-color":"#777",src:t.getImageURL(t.activityData.meta.logoImage["@id"])}}):t._e(),t._v("\n        "+t._s(t.activityData.name)+"\n      ")],1)])],1),t._v(" "),a("b-row",[a("b-col",[a("p",{staticClass:"lead text-center"},[t._v("\n        "+t._s(t.activityData.meta.description)+"\n      ")])])],1),t._v(" "),a("b-row",[a("b-col",{staticClass:"text-center"},[a("h3",[t._v(t._s(t.activityData.meta.members.editors.length))]),t._v(" "),a("p",[t._v("Editors")])]),t._v(" "),a("b-col",{staticClass:"text-center"},[a("h3",[t._v(t._s(t.activityData.meta.members.managers.length))]),t._v(" "),a("p",[t._v("Managers")])]),t._v(" "),a("b-col",{staticClass:"text-center"},[a("h3",[t._v(t._s(t.activityData.meta.members.users.length))]),t._v(" "),a("p",[t._v("Users")])]),t._v(" "),a("b-col",{staticClass:"text-center"},[a("h3",[t._v(t._s(Object.keys(t.activityData.meta.members.viewers).length))]),t._v(" "),a("p",[t._v("Viewers")])])],1)],1)},staticRenderFns:[]};var P=a("VU/8")(H,B,!1,function(t){a("Uy0G")},null,null).exports,W=a("PJh5"),X=a.n(W),K={name:"SubTable",props:{responseData:{type:Array}},methods:{extractData:function(t){return t.data?t.data.survey?t.data.survey:t.data.text?t.data.text:"FIX":null}},computed:{tableData:function(){var t=this;return l.a.filter(l.a.map(this.responseData,function(e){return{text:e.text,survey:t.extractData(e)}}),function(t){return null!=t.survey})}}},Z={render:function(){var t=this.$createElement;return(this._self._c||t)("b-table",{attrs:{striped:"",items:this.tableData,"thead-class":"hidden"}})},staticRenderFns:[]};var J=a("VU/8")(K,Z,!1,function(t){a("scZD")},null,null).exports;window.moment=X.a;var Q={name:"ActivityView",props:{activity:{type:Array}},components:{SubTable:J},data:function(){return{tableFields:["datetime","response"]}},computed:{activityDataTable:function(){return l.a.map(this.activity,function(t){return{datetime:X()(t.created).format("MMM Do, Y @ h:mm A"),responses:t.meta.responses}})}}},Y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("b-table",{attrs:{hover:"",items:this.activityDataTable,fields:this.tableFields},scopedSlots:this._u([{key:"response",fn:function(t){return[e("SubTable",{attrs:{responseData:t.item.responses}})]}}])})],1)},staticRenderFns:[]},tt=a("VU/8")(Q,Y,!1,null,null,null).exports,et={name:"Error",props:{error:{type:Object}}},at={render:function(){var t=this.$createElement,e=this._self._c||t;return e("b-container",[e("b-alert",{attrs:{show:"",variant:"danger"}},[this._v(this._s(this.error.message))])],1)},staticRenderFns:[]},st=a("VU/8")(et,at,!1,null,null,null).exports,rt=a("A4r5"),it=(a("Hp3F"),a("vwbq"));window.d3=it;var nt={name:"ActivityCalendar",props:{activity:{type:Array},width:{type:Number},tMin:{type:Object},tMax:{type:Object},idx:{type:Number},height:{type:Number,default:50},padding:{type:Number,default:5},color:{type:String,default:"red"},role:{type:String,default:"data"},title:{type:String,default:""}},data:function(){return{brush:null}},methods:{getXScale:function(){return this.tMin&&this.tMax&&this.width?it.scaleTime().domain([this.tMin.toDate(),this.tMax.toDate()]).range([this.padding,this.width-2*this.padding]):null},drawAxis:function(){it.select(this.$refs.g).call(it.axisBottom(this.xScale).ticks(5))},drawDots:function(){var t=this,e="data"===this.role?"dot":"scrubDot";it.select(this.$refs.g).selectAll("."+e).data(this.activity).enter().append("circle").attr("class",e),it.select(this.$refs.g).selectAll("."+e).attr("cy",0).attr("cx",function(e){return t.xScale(X()(e.updated).toDate())}).attr("r",5).attr("fill",this.color)},brushed:function(){var t=it.event.selection;if(t){var e=t.map(this.xScale.invert,this.xScale);this.$emit("setRange",e)}else this.$emit("setRange",[this.tMin,this.tMax])},drawScrub:function(){var t=it.brushX().extent([[this.padding,0],[this.width-2*this.padding,this.height]]).on("brush end",this.brushed);this.brush=t,it.select(this.$refs.brush).call(t)},redrawScrub:function(t,e){this.brush.on("brush end",null);var a=[this.xScale(t.toDate()),this.xScale(e.toDate())];l.a.isEqual(a,this.xScale.range())?it.select(this.$refs.brush).call(this.brush.move,null):it.select(this.$refs.brush).call(this.brush.move,a),this.brush.on("brush end",this.brushed)}},computed:{xScale:function(){var t=this.getXScale();return t?this.getXScale():null},yTrans:function(){return this.idx*this.height}},watch:{width:function(){this.width&&this.xScale&&(this.drawAxis(),this.drawDots(),"scrub"===this.role&&this.drawScrub())},tMin:function(){this.drawAxis(),this.drawDots()},tMax:function(){this.drawAxis(),this.drawDots()}},mounted:function(){this.width&&this.xScale&&(this.drawAxis(),this.drawDots(),"scrub"===this.role&&this.drawScrub())}},ot={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("g",{ref:"g",staticClass:"activityAxis",attrs:{transform:"translate("+t.padding+", "+(t.yTrans+2*t.padding)+")","text-anchor":"left"}},[a("text",{attrs:{x:t.padding,y:-t.padding,fill:"black","text-anchor":"start"}},[t._v("\n    "+t._s(t.title)+"\n  ")]),t._v(" "),"scrub"===t.role?a("g",{ref:"brush",staticClass:"brush",attrs:{transform:"translate(0, -"+t.height/2+")"}}):t._e()])},staticRenderFns:[]};var lt=a("VU/8")(nt,ot,!1,function(t){a("4QcR")},null,null).exports;s.a.use(rt.a);var ct=a("vwbq"),ut={name:"AllActivitiesCalendar",props:{id:{type:String,required:!0},data:{type:Array},isBoss:{type:Boolean,default:!1},dateRange:{type:Array},filterDateRange:{type:Array}},components:{ActivityCalendar:lt},data:function(){return{width:0,height:0,tMin:null,tMax:null,sMin:null,sMax:null,axisHeight:50,padding:15}},created:function(){if(!this.isBoss&&this.dateRange)this.tMin=this.dateRange[0],this.sMin=this.dateRange[0],this.tMax=this.dateRange[1],this.sMax=this.dateRange[1];else{var t=this.getDateRange(),e=t.min,a=t.max;this.tMin=e,this.sMin=e,this.tMax=a,this.sMax=a,this.isBoss&&this.$emit("setGlobalDateRange",[e,a])}},watch:{dateRange:function(){!this.isBoss&&this.dateRange&&(this.tMin=this.dateRange[0],this.sMin=this.dateRange[0],this.tMax=this.dateRange[1],this.sMax=this.dateRange[1])},filterDateRange:function(){this.tMin=this.filterDateRange[0],this.tMax=this.filterDateRange[1],this.$refs.scrub.redrawScrub(this.tMin,this.tMax),this.$forceUpdate()}},computed:{dataFlat:function(){var t=l.a.map([].concat.apply([],this.data),l.a.clone);return t}},methods:{handleResize:function(){this.width=this.getWidth()},getWidth:function(){return this.$refs.chart.clientWidth},setHeight:function(t){var e=t+2*this.padding;ct.select(this.$refs.chart).style("height",e+"px")},getDateRange:function(){var t=[];return l.a.map(this.data,function(e){l.a.map(e,function(e){t.push(X()(e.created))})}),{min:X.a.min(t),max:X.a.max(t)}},getColor:function(t){return ct.schemeCategory10[t%10]},setNewRange:function(t){var e=l.a.map(t,function(t){return X()(t.toISOString())}),a=X.a.min(e),s=X.a.max(e);this.tMin=a,this.tMax=s,this.$forceUpdate(),this.$emit("setFilterDateRange",[a,s])}},mounted:function(){this.width=this.getWidth(),this.height=this.setHeight((this.data.length+1)*this.axisHeight),this.getDateRange()}},dt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"chart"}},[a("svg",{ref:"chart",attrs:{id:t.id}},[t._l(t.data,function(e,s){return a("activity-calendar",{key:e.name,attrs:{width:t.width,activity:e,tMin:t.tMin,tMax:t.tMax,idx:s,title:e[0].meta.activity.name,height:t.axisHeight,padding:t.padding,color:t.getColor(s)}})}),t._v(" "),a("activity-calendar",{key:"scrubber",ref:"scrub",attrs:{activity:t.dataFlat,width:t.width,tMin:t.sMin,tMax:t.sMax,idx:t.data.length,height:t.axisHeight,padding:t.padding,role:"scrub",color:"white",title:"Zoom / Pan"},on:{setRange:t.setNewRange}})],2),t._v(" "),a("resize-observer",{on:{notify:t.handleResize}})],1)},staticRenderFns:[]};var ht=a("VU/8")(ut,dt,!1,function(t){a("aZMM")},"data-v-5f610b8c",null).exports,mt={name:"ViewActivityUser",props:{authToken:{type:Object},activityData:{type:Object}},components:{ActivityView:tt,Loading:L,Error:st,AllActivitesCalendar:ht},computed:{userId:function(){return this.$route.params.userId},activities:function(){return l.a.groupBy(this.userData,function(t){return t.meta.activity["@id"]})},activitiesArray:function(){return l.a.map(this.activities,function(t){return t})}},data:function(){return{userMetaData:{},userData:[],status:"loading",error:{message:null,response:null},globalDateRange:null,filterDateRange:null}},methods:{getUserMetadata:function(){var t=this;return I(this.userId).then(function(e){t.userMetaData=e.data}).catch(function(e){t.error.message=e.message})},getUserData:function(){var t,e,a=this;return this.status="loading",(t=this.userId,e=this.authToken.token,j()({method:"get",url:x+"/folder?parentType=user&parentId="+t+"&name=Responses",headers:{"Girder-Token":""+e}})).then(function(t){if(!t.data.length)throw{message:"User "+a.userId+" has an empty data folder!\n              Check "+x+"/folder?parentType=user&parentId="+a.userId+"&name=Responses"};return t.data[0]._id}).then(function(t){return e=t,s=a.authToken.token,j()({method:"get",url:x+"/folder?parentType=folder&parentId="+e,headers:{"Girder-Token":""+s}});var e,s}).then(function(t){return l.a.filter(t.data,function(t){return t.name===a.activityData.name})[0]._id}).then(function(t){return e=t,s=a.authToken.token,j()({method:"get",url:x+"/item?folderId="+e+"&limit=5000",headers:{"Girder-Token":""+s}});var e,s}).then(function(t){a.userData=t.data,a.status="ready"}).catch(function(t){a.error.message=t.message,a.status="error"})},scrollTo:function(t){console.log("going to scroll to",t),setTimeout(function(){location.href=t},1e3)},setGlobalDateRange:function(t){this.globalDateRange=t,this.$forceUpdate()},setFilterDateRange:function(t){this.filterDateRange=t,this.$forceUpdate()}},watch:{userId:function(){this.status="loading",this.getUserMetadata().then(this.getUserData)}},mounted:function(){var t=this;this.getUserMetadata().then(this.getUserData).then(function(){console.log("hash?",t.$route.hash),t.$route.hash&&setTimeout(function(){return t.scrollTo(t.$route.hash)},1e3)})}},vt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["loading"===t.status?a("Loading"):"error"===t.status?a("Error",{attrs:{error:t.error}}):a("b-container",[a("b-row",[a("b-col",{staticClass:"text-center"},[a("h1",{attrs:{id:"user"}},[a("b-img",{attrs:{thumbnail:"",rounded:"",width:"75",height:"75","blank-color":"#777",src:t.userMetaData.gravatar_baseUrl}}),t._v("\n\n          "+t._s(t.userMetaData.firstName)+" "+t._s(t.userMetaData.lastName)+"\n        ")],1),t._v(" "),a("p",{staticClass:"lead"},[t._v(t._s(t.userMetaData.login))])])],1),t._v(" "),a("b-row",{staticClass:"mb-3"},[a("b-col",[a("all-activites-calendar",{attrs:{id:"chart__"+t.userId,data:t.activitiesArray,isBoss:!0,filterDateRange:t.filterDateRange},on:{setGlobalDateRange:t.setGlobalDateRange,setFilterDateRange:t.setFilterDateRange}})],1)],1),t._v(" "),a("b-row",[a("b-col",[a("h5",[t._v(" Activities in "+t._s(t.activityData.name)+": ")])]),t._v(" "),a("b-col",{attrs:{offset:"1",cols:"11"}},t._l(t.activities,function(e){return a("div",{key:e._id,staticClass:"mt-2"},[a("p",[a("a",{attrs:{href:"#"+e[0].meta.activity.name}},[t._v("\n                "+t._s(e[0].meta.activity.name)+" ("+t._s(e.length)+")\n              ")])])])}),0)],1),t._v(" "),a("b-row",[a("b-col",t._l(t.activities,function(e,s){return a("div",{key:e._id,staticClass:"mt-2"},[a("h2",{staticClass:"mb-0 pb-0",attrs:{id:e[0].meta.activity.name}},[t._v("\n            "+t._s(e[0].meta.activity.name)+" ("+t._s(e.length)+")\n          ")]),t._v(" "),a("div",{staticClass:"mb-3"},[a("small",[a("a",{attrs:{href:"#user"}},[t._v("go to top")])])]),t._v(" "),a("all-activites-calendar",{attrs:{id:"subchart__"+s,data:[e],dateRange:t.globalDateRange,filterDateRange:t.filterDateRange},on:{setFilterDateRange:t.setFilterDateRange}}),t._v(" "),a("ActivityView",{attrs:{activity:e}})],1)}),0)],1)],1)],1)},staticRenderFns:[]};var ft=a("VU/8")(mt,vt,!1,function(t){a("yyKo")},"data-v-5102dc8a",null).exports;s.a.use(m.a);var pt=new m.a({mode:"history",routes:[{path:"/",name:"Home",component:p},{path:"/login",name:"Login",component:R},{path:"/signup",name:"SignUp",component:T},{path:"/signup",name:"SignUp",component:T},{path:"/activitySets",name:"ActivitySets",component:E},{path:"/view_activity/:activityId",component:G,redirect:"/view_activity/:activityId/overview",children:[{name:"overview",path:"overview",component:P},{name:"view_user",path:"view_user/:userId",component:ft}]}]});s.a.config.productionTip=!1,new s.a({el:"#app",router:pt,components:{App:h},template:"<App/>"})},SBQD:function(t,e){},Uy0G:function(t,e){},Vdvp:function(t,e){},VlMO:function(t,e){},aZMM:function(t,e){},aecc:function(t,e){},f47A:function(t,e,a){t.exports=a.p+"static/img/undraw_prototyping_process_rswj.67fa892.svg"},jKqc:function(t,e){},scZD:function(t,e){},uslO:function(t,e,a){var s={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ku":"kI9l","./ku.js":"kI9l","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function r(t){return a(i(t))}function i(t){var e=s[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}r.keys=function(){return Object.keys(s)},r.resolve=i,t.exports=r,r.id="uslO"},yyKo:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.5938b3c3d2dc3944a3bb.js.map